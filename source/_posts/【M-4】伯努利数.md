---
title: 【M#4】伯努利数
date: 2024-01-07 20:17:43
tags: 具体数学
categories: M
mathjax: enable
---

## Bernoulli Number

伯努利数由 EGF 定义

$$\mathcal B(z)=\frac{z}{e^z-1}=\sum_{n=0}^\infty \frac{B_n}{n!}z^n \tag{1}$$

利用这个定义暴力展开生成函数，我们可以算出伯努利数的前几项。

$$
\begin{matrix}
n  & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 \\
B_n  & 1 & -1/2  & 1/6 & 0 & -1/30 & 0 & 1/42 & 0 & -1/30 & 0 & 5/66 & 0 & -691/2730
\end{matrix}
$$


注意到这些数都比较丑，并且 $\geq 3$ 的奇数都是 $0$，这一点可以注意到 $\dfrac{z}{e^z-1}+\dfrac{z}{2}$ 是一个偶函数。

事实上，伯努利数并不存在封闭形式，这一点可以从 $-691/2730$ 这样一个诡异的形式中看出来。

另一种定义伯努利数的方法是通过递推定义，这一种定义和生成函数定义是等价的，可以用生成函数导出：

$$\frac{z}{e^z-1}-1=-\frac{z}{e^z-1}(\frac{e^z-1}{z}-1)$$

两边同时取 $z^n$ 项，我们得到

$$B_n=-\frac{1}{n+1}\sum_{k=0}^{n-1}\binom{n+1}{k}B_k \tag{2}$$

## Zeta Function at Positive Even Integers

伯努利数的一个重要应用就是他可以表示一类函数的展开系数，如 $\zeta$ 函数，其在 $2n(n\in\mathbb Z)$ 处的定义为

$$\zeta(2n)=\sum_{m=1}^\infty \frac{1}{m^{2n}} \tag{3}$$

为了导出 $\zeta$ 函数的级数表示，我们首先研究一下 $z\cot z$ 的展开。

$$
\begin{aligned}
z\cot z &=(iz)\frac{e^{iz}+e^{-iz}}{e^{iz}-e^{-iz}} \\
&=\frac{1}{2}(2iz)\Big(\frac{1}{1-e^{-2iz}}+\frac{1}{e^{2iz}-1}\Big) \\
&=\frac{1}{2}(\mathcal B(2iz)+\mathcal B(-2iz)) \\
&=1+\sum_{n=1}^\infty (-1)^n\frac{2^{2n}B_{2n}}{(2n)!}z^{2n} 
\end{aligned}\tag{4}
$$


另一方面，对于 $\cot z$ 我们有经典的公式

$$\cot z=\frac{1}{z}+2\sum_{n=1}^\infty \frac{z}{z^2-n^2\pi^2}$$

则有

$$
\begin{aligned}
z\cot z &=1+2\sum_{n=1}^\infty \frac{(\dfrac{z}{n\pi})^2}{(\dfrac{z}{n\pi})^2-1} \\
&=1-2\sum_{n=1}^\infty \sum_{j\in2\mathbb Z^+}\frac{z^j}{n^j\pi^j} \\
&=1-2\sum_{n=1}^\infty\frac{\zeta(2n)}{\pi^{2n}}z^{2n} 
\end{aligned}\tag{5}
$$

对比 $(4),(5)$ 的系数，我们可以得到

$$\zeta(2n)=\frac{(-1)^{n+1}}{2}\frac{(2\pi)^{2n}}{(2n)!}B_{2n} \tag{6}$$

事实上，伯努利数还出现在更多的函数的表达式中，如将 $\tan z$ 写作 $\cot z-2\cot 2z$，就可以得到 $\tan z$ 的表达式。

## Bernoulli Polynomial

伯努利多项式 $B_n(x)$ 通过生成函数

$$\mathfrak B(x,z)=\frac{ze^{xz}}{e^z-1}=\sum_{n=0}^\infty \frac{B_n(x)}{n!}z^n \tag{7}$$

定义。

把 $\mathfrak B(x,z)$ 写成 $\mathcal B(z)$ 和 $e^{xz}$ 的卷积的形式，比较系数就得到

$$B_n(x)=\sum_{k=0}^n \binom{n}{k}B_kx^{n-k} \tag{8}$$

下面两个结论和伯努利数的实际意义有着重要的关联，首先 $B_n(x)$ 在离散微积分意义下和 $x^n$ 很像，具体的，

$$\Delta B_n(x)=B_n(x+1)-B_n(x)=nx^{n-1} \tag{9}$$

证明只需用 $\mathfrak B(x,z+1)-\mathfrak B(x,z)$ 即可。

另一个实际上是伯努利数被发现的原因，即 $x^m$ 的离散积分的系数与 $B_n$ 有着紧密的联系。

设 $S_m(n)=\sum_{k=1}^{n-1}k^m=\sum_1^n x^m\delta x$，则有 

$$(m+1)S_m(n)=B_{m+1}(n)-B_{m+1} \tag{10}$$

证明只需在 $(9)$ 中取 $n=m+1$，然后对 $x$ 从 $1$ 到 $m-1$ 求和即可。

## Bernoulli Denominator

最后我们来考虑一下伯努利数的神秘的分母是什么。

对着表仔细观察可以注意到，他是所有满足 $(p-1)|(2n)$ 的素数 $p$ 的乘积。

我们用数学归纳法证明这个猜想。

注意到这个猜想实际上等价于

$$I_{2n}=B_{2n}+\sum_{p为素数} \frac{[(p-1)|2n]}{p} \tag{11}$$

是一个整数。

观察到，对于素数 $p$ 和 $m>0$，$S_m(p)+[(p-1)|m]=\mathbb Zp$

证明考虑 $m$ 是 $(p-1)$ 的倍数，如果是，则 $S_m(p)\equiv p-1 \bmod p$，否则 $S_m(p)$ 每一项模 $p$ 互不相同，加起来是 $p$ 的倍数。

有了这个结论之后，对于 $(p-1)|2n$ 的 $p$，利用 $(10)$ 取 $m=2n$，将其中的 $B_{m+1}(x)$ 用 $(8)$ 展开。

$$B_{2n}+\frac{[(p-1)|2n]}{p}+\frac{1}{2n+1}\sum_{k=0}^{2n-2}\binom{2n+1}{k}B_kp^{2n+1-k}=S_{2n}(p)+\mathbb Z\in \mathbb Z$$

因此我们只需要证明

$$\frac{1}{2n+1}\sum_{k=0}^{2n-2}\binom{2n+1}{k}B_kp^{2n+1-k}=\sum_{k=0}^{2n-2}\binom{2n}{k}B_kp^2\frac{p^{2n-1-k}}{2n+1-k}$$

是整数即可，因为 $p$ 是素数，这等价于他的分母不能被 $p$ 整除。

由归纳假设，$B_k$ 的分母中不含 $p^2$，因此 $B_kp^2$ 的分母中不含 $p$，而在假设范围内有 $p^{2n-1-k}\geq 2n+1-k$，因此后面一部分的分母里同样没有 $p$，假设成立。

这也就完成了我们的证明。

因为 $2n\geq 2$ 的时候，$2-1,3-1$ 一定整除 $2n$，所以 $\forall n\geq 1$,$B_{2n}$ 的分母一定是 $6$ 的倍数。