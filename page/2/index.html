<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"06devout.github.io","root":"/blog/","images":"/blog/images","scheme":"Muse","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/blog/js/config.js"></script>

    <meta name="description" content="拼命地，想把双手伸向暗云的天空中 ...为了寻找那远而不可及的彼岸的某些东西">
<meta property="og:type" content="website">
<meta property="og:title" content="devout">
<meta property="og:url" content="https://06devout.github.io/blog/page/2/index.html">
<meta property="og:site_name" content="devout">
<meta property="og:description" content="拼命地，想把双手伸向暗云的天空中 ...为了寻找那远而不可及的彼岸的某些东西">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="devout">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://06devout.github.io/blog/page/2/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/2/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>devout</title>
  








  <noscript>
    <link rel="stylesheet" href="/blog/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">devout</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">水晶宫里奏霓裳，准拟岳阳楼上</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/blog/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/blog/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="devout"
      src="https://cdn.luogu.com.cn/upload/usericon/97344.png">
  <p class="site-author-name" itemprop="name">devout</p>
  <div class="site-description" itemprop="description">拼命地，想把双手伸向暗云的天空中 ...为了寻找那远而不可及的彼岸的某些东西</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/blog/archives/">
          <span class="site-state-item-count">49</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/blog/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/blog/tags/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://www.luogu.com.cn/user/97344" title="Luogu → https:&#x2F;&#x2F;www.luogu.com.cn&#x2F;user&#x2F;97344" rel="noopener me" target="_blank">Luogu</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/devout-29-51" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;devout-29-51" rel="noopener me" target="_blank">Zhihu</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/06devout" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;06devout" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:2062593323@qq.com" title="E-Mail → mailto:2062593323@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://stackexchange.com/users/28797913/yumesaki-yuuki" title="Stackexchange → https:&#x2F;&#x2F;stackexchange.com&#x2F;users&#x2F;28797913&#x2F;yumesaki-yuuki" rel="noopener me" target="_blank">Stackexchange</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/YuukiYumesaki" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;YuukiYumesaki" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://youtube.com/channel/UCgUPaHs4mkEX7qsx0C-ObFA" title="YouTube → https:&#x2F;&#x2F;youtube.com&#x2F;channel&#x2F;UCgUPaHs4mkEX7qsx0C-ObFA" rel="noopener me" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          Links
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://www.luogu.com.cn/user/199139" title="https:&#x2F;&#x2F;www.luogu.com.cn&#x2F;user&#x2F;199139" rel="noopener" target="_blank">devans</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://06devout.github.io/blog/2024/01/20/%E3%80%90M-5%E3%80%91Van-der-Corput-Difference-Theorem/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.luogu.com.cn/upload/usericon/97344.png">
      <meta itemprop="name" content="devout">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devout">
      <meta itemprop="description" content="拼命地，想把双手伸向暗云的天空中 ...为了寻找那远而不可及的彼岸的某些东西">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | devout">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2024/01/20/%E3%80%90M-5%E3%80%91Van-der-Corput-Difference-Theorem/" class="post-title-link" itemprop="url">【M#5】Van der Corput Difference Theorem</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-01-20 09:00:52 / Modified: 09:27:14" itemprop="dateCreated datePublished" datetime="2024-01-20T09:00:52+08:00">2024-01-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/M/" itemprop="url" rel="index"><span itemprop="name">M</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p><strong>Van der Corput Difference Theomrem:</strong> 对于数列 <span
class="math inline">\(\{f(n)\}_n\)</span>，若 <span
class="math inline">\(\forall h\in \mathbb Z\)</span> ,<span
class="math inline">\(\{f(n+h)-f(n)\}_n\)</span> 在 <span
class="math inline">\([0,1]\)</span> 上等分布，则 <span
class="math inline">\(\{f(n)\}_n\)</span> 在 <span
class="math inline">\([0,1]\)</span> 上等分布。</p>
</blockquote>
<p>我们首先证明一个引理：</p>
<blockquote>
<p><strong>Lemma(Van der Corput's Fundamental Inequality):</strong> 设
<span class="math inline">\(\{u_n\}_{n=1}^N\in\mathbb C,H\in\mathbb
Z,1\leq H\leq N\)</span>，则有</p>
<p><span class="math display">\[H^2\Bigg|\sum_{n=1}^N u_n\Bigg|^2\leq
\color{red}{H(N+H-1)\sum_{n=1}^N
|u_n|^2}+\color{green}2(N+H-1)\sum_{h=1}^{H-1}(H-h)\Re\sum_{n=1}^{N-h}u_n\overline{u_{n+h}}
\tag{1}\]</span></p>
</blockquote>
<p>证明考虑把 <span class="math inline">\(u_n\)</span> 拓展定义到 <span
class="math inline">\(\{u_n\}_n\)</span>，其中 <span
class="math inline">\(u_k=0,k&gt;N\)</span>，那么有</p>
<p><span class="math display">\[H\Bigg|\sum_{n=1}^N
u_n\Bigg|=\sum_{p=1}^{N+H-1}\sum_{h=0}^{H-1}u_{p-h}=\sum_{p=1}^{N+H-1}\Bigg(1\cdot
\sum_{h=0}^{H-1}u_{p-h}\Bigg)\]</span></p>
<p>两边用 Cauchy-Schwartz 不等式</p>
<p><span class="math display">\[
\begin{aligned}
H^2\Bigg|\sum_{n=1}^N u_n\Bigg|^2 &amp;\leq
(N+H-1)\sum_{p=1}^{N+H-1}\Bigg(\sum_{h=0}^{H-1}u_{p-h}\Bigg)^2 \\
&amp;=(N+H-1)\sum_{p=1}^{N+H-1}\Bigg(\sum_{h_1=0}^{H-1}u_{p-h_1}\Bigg)\Bigg(\sum_{h_2=0}^{H-1}\overline{u_{p-h_2}}\Bigg)
\end{aligned}
\]</span></p>
<p>对于 <span class="math inline">\(h_1=h_2\)</span>
的单独提出来，就得到了 <span class="math inline">\((1)\)</span>
中红色的部分</p>
<p>对于 <span class="math inline">\(h_1\neq h_2\)</span> 的部分，考虑
<span class="math inline">\(|h_1-h_2|=h\)</span> 的 <span
class="math inline">\(u_n\overline{u_{n+h}}\)</span>
一共出现的次数，以及注意到结果一定是实数，所以虚部抵消掉了，就得到了绿色的部分。</p>
<p>证明了引理之后，我们取 <span class="math inline">\(u_n=e^{2\pi
if(n)}\)</span>，得到</p>
<p><span class="math display">\[|S_N|^2\leq
\frac{H(N+H-1)N}{H^2}+\frac{\sum_{h=1}^{H-1}2(N+H-1)H|\sum_{n=1}^{N-h}e^{2\pi
i(f(n+h)-f(n))}|}{H^2}\]</span></p>
<p>接下来利用放缩 <span class="math inline">\(N+H-1\leq 2N\)</span>
得到</p>
<p><span class="math display">\[
\begin{aligned}
|S_N|^2&amp;\leq
\frac{4N}{H}\sum_{h=1}^{H-1}\Bigg|\sum_{n=1}^{N-h}e^{2\pi
i(f(n+h)-f(n))}\Bigg| \\
&amp;\leq
\frac{4N^2}{H}\sum_{h=1}^{H-1}\Bigg|\frac{1}{N-h}\sum_{n=1}^{N-h}e^{2\pi
i(f(n+h)-f(n))}\Bigg|
\end{aligned}
\]</span></p>
<p>由定理假设，以及 <span class="math inline">\(H\)</span>
为有限数，得后面大 sigma 里面是 <span
class="math inline">\(o(1)\)</span>，故 <span
class="math inline">\(|S_N|^2=o(N^2)\)</span>，即证明 <span
class="math inline">\(\{f(n)\}\)</span> 是等分布 <span
class="math inline">\([0,1]\)</span> 上的序列。</p>
<p>一些应用：</p>
<p>对于 <span class="math inline">\(\sigma&gt;0,a\neq\in\mathbb
Z\)</span>,<span class="math inline">\(\{an^\sigma\}\)</span> 在 <span
class="math inline">\([0,1]\)</span> 为等部分序列。</p>
<p>在 Exercise 8 中我们已经证明了 <span
class="math inline">\(\sigma\in(0,1)\)</span> 的时候的结果，对于 <span
class="math inline">\(\sigma\in (k,k+1)\)</span>
只需要每次差分然后数学归纳即可。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://06devout.github.io/blog/2024/01/09/Steins-%E5%82%85%E9%87%8C%E5%8F%B6%E5%88%86%E6%9E%90-%E7%AC%AC%E5%9B%9B%E7%AB%A0%E9%83%A8%E5%88%86%E4%B9%A0%E9%A2%98%E8%A7%A3%E7%AD%94/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.luogu.com.cn/upload/usericon/97344.png">
      <meta itemprop="name" content="devout">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devout">
      <meta itemprop="description" content="拼命地，想把双手伸向暗云的天空中 ...为了寻找那远而不可及的彼岸的某些东西">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | devout">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2024/01/09/Steins-%E5%82%85%E9%87%8C%E5%8F%B6%E5%88%86%E6%9E%90-%E7%AC%AC%E5%9B%9B%E7%AB%A0%E9%83%A8%E5%88%86%E4%B9%A0%E9%A2%98%E8%A7%A3%E7%AD%94/" class="post-title-link" itemprop="url">Steins 傅里叶分析 第四章部分习题解答</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-01-09 19:23:41" itemprop="dateCreated datePublished" datetime="2024-01-09T19:23:41+08:00">2024-01-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-01-15 20:54:32" itemprop="dateModified" datetime="2024-01-15T20:54:32+08:00">2024-01-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Steins-I/" itemprop="url" rel="index"><span itemprop="name">Steins I</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="exercise-4">Exercise 4</h2>
<p><span class="math inline">\((\text{Wirtinger} \Rightarrow
\text{isoperimetric})\)</span>：</p>
<p><span class="math display">\[
\begin{aligned}
2(\pi-\mathcal A)&amp;=\int_{-\pi}^\pi
[x^\prime(s)^2+y^\prime(s)^2]\mathrm ds-\int_{-\pi}^\pi
[x(s)y^\prime(s)-y(x)x^\prime(s)]\mathrm ds \\
&amp;= \int_{-\pi}^\pi [x^\prime(s)+y(s)]^2\mathrm
ds+\int_{-\pi}^\pi[y^\prime(s)^2-y^2(s)]\mathrm ds \\
&amp;\geq 0
\end{aligned}
\]</span></p>
<p>最后一步利用 Wirtinger 不等式。</p>
<p><span class="math inline">\((\text{isoperimetric} \Rightarrow
\text{wirtinger})\)</span>:</p>
<p>因为 <span class="math inline">\(f\)</span> 连续，所以 <span
class="math inline">\(f\)</span> 有原函数，设 <span
class="math inline">\(g\)</span> 满足 <span
class="math inline">\(g^\prime=-f\)</span></p>
<p>考虑 <span class="math inline">\(\gamma:[-\pi,\pi]\to \mathbb
R^2:t\to(g(t),f(t))\)</span></p>
$$
<span class="math display">\[\begin{aligned}
\int_{-\pi}^\pi [f^\prime(t)^2-f^2(t)]\mathrm dt &amp;= \int_{-\pi}^\pi
[g^\prime(t)+f(t)]^2\mathrm dt+\int_{-\pi}^\pi
[f^\prime(t)^2-f^2(t)]\mathrm dt \\
&amp;=\int_{-\pi}^\pi
[g^\prime(t)^2+2g^\prime(t)f(t)+f^\prime(t)^2]\mathrm dt \\
&amp;=\int_{-\pi}^\pi [g^\prime(t)^2+f^\prime(t)^2]\mathrm dt -2\mathcal
A \\
&amp;\overset{Cauchy}{\geq} \frac{1}{2\pi} \Bigg(\int_{-\pi}^\pi
\sqrt{g^\prime(t)^2+f^\prime(t)^2}\mathrm dt \Bigg)^2-2\mathcal A \\
&amp;=2(\pi-\mathcal A) \\
&amp;\geq 0

\end{aligned}\]</span>
<p>$$</p>
<h2 id="exercise-5">Exercise 5</h2>
<p>注意到</p>
<p><span class="math display">\[(\frac{1-\sqrt 5}{2})^n+(\frac{\sqrt
5+1}{2})^n\]</span></p>
<p>是 <span
class="math inline">\(a_n=a_{n-1}+a_{n-2},a_1=1,a_2=2\)</span>
的通项公式，而 <span class="math inline">\((\frac{1-\sqrt 5}{2})^n\to
0\)</span>，故随 <span
class="math inline">\(n\to\infty\)</span>，后面一项无限接近一个整数。</p>
<h2 id="exercise-8">Exercise 8</h2>
<p><span class="math display">\[\Big|\sum_{n=1}^N e^{2\pi
ibn^\sigma}\Big|\leq \Big |\sum_{n=1}^Ne^{2\pi ibn^\sigma}-\int_1^N
e^{2\pi ibx^\sigma}\mathrm dx\Big|+\Big|\int_1^N e^{2\pi i
bx^\sigma}\mathrm dx \Big|\]</span></p>
<p>而后一项可以利用分部积分提出一个 <span class="math inline">\(e^{2\pi
i b x^\sigma}\)</span>，证明他是 <span
class="math inline">\(O(N^{1-\sigma})\)</span>，前一项可以 <span
class="math inline">\((n,n+1)\)</span> 分开考虑放缩，得到 <span
class="math inline">\(O(N^\sigma)\)</span>，即得证。</p>
<h2 id="exercise-9">Exercise 9</h2>
<p>这次是证明</p>
<p><span class="math display">\[\lim_{N\to\infty}\frac{1}{N}\sum_{n=1}^N
e^{2\pi ib\ln n}&gt;0\]</span></p>
<p>我们还是拆分成 <span class="math inline">\(\sum-\int_1^N\)</span> 和
<span class="math inline">\(\int_1^N\)</span> 两部分，注意到 <span
class="math inline">\(\sum-\int_1^N=O(\log
n)\)</span>，因此不会对极限造成影响，而 <span
class="math inline">\(\int_1^N\)</span> 的结果是 <span
class="math inline">\((N^{2\pi ib+1}-1)/(2\pi ib+1)\)</span>，由 <span
class="math inline">\(|N^{2\pi ib}|=1\)</span> 知最后的极限是 <span
class="math inline">\(1/(2\pi i b+1)\)</span></p>
<h2 id="exercise-11">Exercise 11</h2>
<p>首先求出 <span class="math inline">\(u-f\)</span> 的傅里叶系数</p>
<p><span
class="math display">\[\widehat{u-f}(n)=\widehat{(f*H_t)}(n)-\widehat
f(n)=\widehat f(n)[e^{-4\pi^2n^2t^2}-1]\]</span></p>
<p>由 Parseval</p>
<p><span class="math display">\[\int_0^1 |u(x,t)-f(x)|^2\mathrm dx=\sum
|\hat f(n)|^2+|\widehat{H_t}(n)-1|^2\mathrm dx\]</span></p>
<p>对于 <span class="math inline">\(\forall \epsilon&gt;0\)</span></p>
<p>注意到因为 <span
class="math inline">\(||f||&lt;\infty\)</span>，所以存在 <span
class="math inline">\(N\)</span> 使得</p>
<p><span class="math display">\[\sum_{|n|&gt;N} |\hat f(n)|&lt;\sqrt
\epsilon\]</span></p>
<p>因此对于 <span class="math inline">\(|n|&gt;N\)</span> 的部分，由
<span class="math inline">\(|\widehat{H_t}(n)-1|\leq 1\)</span>
可知后面的和 <span class="math inline">\(&lt;\epsilon\)</span></p>
<p>对于 <span class="math inline">\(|n|\leq N\)</span>
的部分，我们只需要 <span
class="math inline">\(|\widehat{H_t}(n)-1|&lt;\sqrt \epsilon(\forall
t&lt;\delta)\)</span> 即可，可取 <span
class="math inline">\(\delta=\dfrac{\ln(1-\sqrt
\epsilon)}{4\pi^2N^2}\)</span></p>
<p>这样 <span class="math inline">\(\sum=\sum_{|n|\leq
N}+\sum_{|n|&gt;N}\leq ||f||\epsilon+\epsilon=O(\epsilon) (t\to
0)\)</span>，即证。</p>
<h2 id="exercise-13b">Exercise 13(b)</h2>
<p>感觉主要是想到第一步，后面都比较机械了。</p>
<p>先用 Jordan 不等式 <span class="math inline">\(|x|\leq
\dfrac{1}{2}|\sin \pi x|,x\in
[-\dfrac{1}{2},\dfrac{1}{2}]\)</span>，转化成 <span
class="math inline">\(\int |\sin\pi xH_t(x)|^2\mathrm dx\)</span>，然后
Parseval，转化成傅里叶系数平方求和，用 <span
class="math inline">\(\dfrac{1}{2i}(e^{i\pi x}-e^{-i\pi x})\)</span>
代替 <span class="math inline">\(\sin x\)</span>，最后可以转化成 <span
class="math inline">\(\pi^4t^2\sum |(2n+1)^2e^{-8\pi^2 x^2 t}|\)</span>
的形式，再转换成积分的形式，求阶即可。</p>
<h2 id="problem-1">Problem 1</h2>
<ol type="a">
<li>用 Exercise 15 Chap.3 的结论，有</li>
</ol>
<p><span class="math display">\[2|a_n|=\frac{1}{2\pi}\int_{-\pi}^\pi
(\gamma(t)-\gamma(t+\pi/n))e^{-int}\mathrm dt\]</span></p>
<ol start="2" type="a">
<li>设 <span class="math inline">\(t\)</span> 为 <span
class="math inline">\(\gamma(\tau)\)</span> 的切线与 <span
class="math inline">\(y\)</span> 轴的夹角，则 <span
class="math inline">\(\gamma^\prime(t)\)</span> 可写作 <span
class="math inline">\(ie^{it}r(t)\)</span>，其中 <span
class="math inline">\(r(t)\)</span> 控制在 <span
class="math inline">\(\tau(t)\)</span> 处的切线长度，则 <span
class="math inline">\(r(t)\)</span> 是周期为 <span
class="math inline">\(2\pi\)</span> 的实值函数且 <span
class="math inline">\(r(t)=-r(t+\pi)\)</span></li>
</ol>
<p>由分部积分</p>
<p><span class="math display">\[\gamma(t)=r(t)e^{it}-\int
r^\prime(t)e^{it}\mathrm dt\]</span></p>
<p>求傅里叶系数得</p>
<p><span class="math display">\[\hat
\gamma(1)=\frac{1}{2\pi}\int_{-\pi}^\pi r(t)\mathrm
dt=\frac{1}{2\pi}\int_{-\pi}^\pi|\gamma^\prime(t)|\mathrm
dt=\frac{\ell}{2\pi}\]</span></p>
<p>再由 <span class="math inline">\(2\hat \gamma(1)\leq d\)</span>
即证。</p>
<h2 id="problem-3">Problem 3</h2>
<p>运用 Problem 2 的结论，数学归纳法，每次差分，直到 <span
class="math inline">\(\sigma\in (0,1)\)</span>。</p>
<h2 id="problem-6">Problem 6</h2>
<p>可将 <span class="math inline">\(f(n)\)</span>
拆成若干段单调有界的函数，因此有 <span class="math inline">\(\hat
f(n)=O(1/n)\)</span>，然后用 Problem 5 的结论。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://06devout.github.io/blog/2024/01/07/%E3%80%90M-4%E3%80%91%E4%BC%AF%E5%8A%AA%E5%88%A9%E6%95%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.luogu.com.cn/upload/usericon/97344.png">
      <meta itemprop="name" content="devout">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devout">
      <meta itemprop="description" content="拼命地，想把双手伸向暗云的天空中 ...为了寻找那远而不可及的彼岸的某些东西">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | devout">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2024/01/07/%E3%80%90M-4%E3%80%91%E4%BC%AF%E5%8A%AA%E5%88%A9%E6%95%B0/" class="post-title-link" itemprop="url">【M#4】伯努利数</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-01-07 20:17:43 / Modified: 21:23:48" itemprop="dateCreated datePublished" datetime="2024-01-07T20:17:43+08:00">2024-01-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/M/" itemprop="url" rel="index"><span itemprop="name">M</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="bernoulli-number">Bernoulli Number</h2>
<p>伯努利数由 EGF 定义</p>
<p><span class="math display">\[\mathcal
B(z)=\frac{z}{e^z-1}=\sum_{n=0}^\infty \frac{B_n}{n!}z^n
\tag{1}\]</span></p>
<p>利用这个定义暴力展开生成函数，我们可以算出伯努利数的前几项。</p>
<p><span class="math display">\[
\begin{matrix}
n  &amp; 0 &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 &amp;
8 &amp; 9 &amp; 10 &amp; 11 &amp; 12 \\
B_n  &amp; 1 &amp; -1/2  &amp; 1/6 &amp; 0 &amp; -1/30 &amp; 0 &amp;
1/42 &amp; 0 &amp; -1/30 &amp; 0 &amp; 5/66 &amp; 0 &amp; -691/2730
\end{matrix}
\]</span></p>
<p>注意到这些数都比较丑，并且 <span class="math inline">\(\geq
3\)</span> 的奇数都是 <span
class="math inline">\(0\)</span>，这一点可以注意到 <span
class="math inline">\(\dfrac{z}{e^z-1}+\dfrac{z}{2}\)</span>
是一个偶函数。</p>
<p>事实上，伯努利数并不存在封闭形式，这一点可以从 <span
class="math inline">\(-691/2730\)</span>
这样一个诡异的形式中看出来。</p>
<p>另一种定义伯努利数的方法是通过递推定义，这一种定义和生成函数定义是等价的，可以用生成函数导出：</p>
<p><span
class="math display">\[\frac{z}{e^z-1}-1=-\frac{z}{e^z-1}(\frac{e^z-1}{z}-1)\]</span></p>
<p>两边同时取 <span class="math inline">\(z^n\)</span> 项，我们得到</p>
<p><span
class="math display">\[B_n=-\frac{1}{n+1}\sum_{k=0}^{n-1}\binom{n+1}{k}B_k
\tag{2}\]</span></p>
<h2 id="zeta-function-at-positive-even-integers">Zeta Function at
Positive Even Integers</h2>
<p>伯努利数的一个重要应用就是他可以表示一类函数的展开系数，如 <span
class="math inline">\(\zeta\)</span> 函数，其在 <span
class="math inline">\(2n(n\in\mathbb Z)\)</span> 处的定义为</p>
<p><span class="math display">\[\zeta(2n)=\sum_{m=1}^\infty
\frac{1}{m^{2n}} \tag{3}\]</span></p>
<p>为了导出 <span class="math inline">\(\zeta\)</span>
函数的级数表示，我们首先研究一下 <span class="math inline">\(z\cot
z\)</span> 的展开。</p>
<p><span class="math display">\[
\begin{aligned}
z\cot z &amp;=(iz)\frac{e^{iz}+e^{-iz}}{e^{iz}-e^{-iz}} \\
&amp;=\frac{1}{2}(2iz)\Big(\frac{1}{1-e^{-2iz}}+\frac{1}{e^{2iz}-1}\Big)
\\
&amp;=\frac{1}{2}(\mathcal B(2iz)+\mathcal B(-2iz)) \\
&amp;=1+\sum_{n=1}^\infty (-1)^n\frac{2^{2n}B_{2n}}{(2n)!}z^{2n}
\end{aligned}\tag{4}
\]</span></p>
<p>另一方面，对于 <span class="math inline">\(\cot z\)</span>
我们有经典的公式</p>
<p><span class="math display">\[\cot z=\frac{1}{z}+2\sum_{n=1}^\infty
\frac{z}{z^2-n^2\pi^2}\]</span></p>
<p>则有</p>
<p><span class="math display">\[
\begin{aligned}
z\cot z &amp;=1+2\sum_{n=1}^\infty
\frac{(\dfrac{z}{n\pi})^2}{(\dfrac{z}{n\pi})^2-1} \\
&amp;=1-2\sum_{n=1}^\infty \sum_{j\in2\mathbb Z^+}\frac{z^j}{n^j\pi^j}
\\
&amp;=1-2\sum_{n=1}^\infty\frac{\zeta(2n)}{\pi^{2n}}z^{2n}
\end{aligned}\tag{5}
\]</span></p>
<p>对比 <span class="math inline">\((4),(5)\)</span>
的系数，我们可以得到</p>
<p><span
class="math display">\[\zeta(2n)=\frac{(-1)^{n+1}}{2}\frac{(2\pi)^{2n}}{(2n)!}B_{2n}
\tag{6}\]</span></p>
<p>事实上，伯努利数还出现在更多的函数的表达式中，如将 <span
class="math inline">\(\tan z\)</span> 写作 <span
class="math inline">\(\cot z-2\cot 2z\)</span>，就可以得到 <span
class="math inline">\(\tan z\)</span> 的表达式。</p>
<h2 id="bernoulli-polynomial">Bernoulli Polynomial</h2>
<p>伯努利多项式 <span class="math inline">\(B_n(x)\)</span>
通过生成函数</p>
<p><span class="math display">\[\mathfrak
B(x,z)=\frac{ze^{xz}}{e^z-1}=\sum_{n=0}^\infty \frac{B_n(x)}{n!}z^n
\tag{7}\]</span></p>
<p>定义。</p>
<p>把 <span class="math inline">\(\mathfrak B(x,z)\)</span> 写成 <span
class="math inline">\(\mathcal B(z)\)</span> 和 <span
class="math inline">\(e^{xz}\)</span> 的卷积的形式，比较系数就得到</p>
<p><span class="math display">\[B_n(x)=\sum_{k=0}^n
\binom{n}{k}B_kx^{n-k} \tag{8}\]</span></p>
<p>下面两个结论和伯努利数的实际意义有着重要的关联，首先 <span
class="math inline">\(B_n(x)\)</span> 在离散微积分意义下和 <span
class="math inline">\(x^n\)</span> 很像，具体的，</p>
<p><span class="math display">\[\Delta B_n(x)=B_n(x+1)-B_n(x)=nx^{n-1}
\tag{9}\]</span></p>
<p>证明只需用 <span class="math inline">\(\mathfrak B(x,z+1)-\mathfrak
B(x,z)\)</span> 即可。</p>
<p>另一个实际上是伯努利数被发现的原因，即 <span
class="math inline">\(x^m\)</span> 的离散积分的系数与 <span
class="math inline">\(B_n\)</span> 有着紧密的联系。</p>
<p>设 <span class="math inline">\(S_m(n)=\sum_{k=1}^{n-1}k^m=\sum_1^n
x^m\delta x\)</span>，则有</p>
<p><span class="math display">\[(m+1)S_m(n)=B_{m+1}(n)-B_{m+1}
\tag{10}\]</span></p>
<p>证明只需在 <span class="math inline">\((9)\)</span> 中取 <span
class="math inline">\(n=m+1\)</span>，然后对 <span
class="math inline">\(x\)</span> 从 <span
class="math inline">\(1\)</span> 到 <span
class="math inline">\(m-1\)</span> 求和即可。</p>
<h2 id="bernoulli-denominator">Bernoulli Denominator</h2>
<p>最后我们来考虑一下伯努利数的神秘的分母是什么。</p>
<p>对着表仔细观察可以注意到，他是所有满足 <span
class="math inline">\((p-1)|(2n)\)</span> 的素数 <span
class="math inline">\(p\)</span> 的乘积。</p>
<p>我们用数学归纳法证明这个猜想。</p>
<p>注意到这个猜想实际上等价于</p>
<p><span class="math display">\[I_{2n}=B_{2n}+\sum_{p为素数}
\frac{[(p-1)|2n]}{p} \tag{11}\]</span></p>
<p>是一个整数。</p>
<p>观察到，对于素数 <span class="math inline">\(p\)</span> 和 <span
class="math inline">\(m&gt;0\)</span>，<span
class="math inline">\(S_m(p)+[(p-1)|m]=\mathbb Zp\)</span></p>
<p>证明考虑 <span class="math inline">\(m\)</span> 是 <span
class="math inline">\((p-1)\)</span> 的倍数，如果是，则 <span
class="math inline">\(S_m(p)\equiv p-1 \bmod p\)</span>，否则 <span
class="math inline">\(S_m(p)\)</span> 每一项模 <span
class="math inline">\(p\)</span> 互不相同，加起来是 <span
class="math inline">\(p\)</span> 的倍数。</p>
<p>有了这个结论之后，对于 <span class="math inline">\((p-1)|2n\)</span>
的 <span class="math inline">\(p\)</span>，利用 <span
class="math inline">\((10)\)</span> 取 <span
class="math inline">\(m=2n\)</span>，将其中的 <span
class="math inline">\(B_{m+1}(x)\)</span> 用 <span
class="math inline">\((8)\)</span> 展开。</p>
<p><span
class="math display">\[B_{2n}+\frac{[(p-1)|2n]}{p}+\frac{1}{2n+1}\sum_{k=0}^{2n-2}\binom{2n+1}{k}B_kp^{2n+1-k}=S_{2n}(p)+\mathbb
Z\in \mathbb Z\]</span></p>
<p>因此我们只需要证明</p>
<p><span
class="math display">\[\frac{1}{2n+1}\sum_{k=0}^{2n-2}\binom{2n+1}{k}B_kp^{2n+1-k}=\sum_{k=0}^{2n-2}\binom{2n}{k}B_kp^2\frac{p^{2n-1-k}}{2n+1-k}\]</span></p>
<p>是整数即可，因为 <span class="math inline">\(p\)</span>
是素数，这等价于他的分母不能被 <span class="math inline">\(p\)</span>
整除。</p>
<p>由归纳假设，<span class="math inline">\(B_k\)</span> 的分母中不含
<span class="math inline">\(p^2\)</span>，因此 <span
class="math inline">\(B_kp^2\)</span> 的分母中不含 <span
class="math inline">\(p\)</span>，而在假设范围内有 <span
class="math inline">\(p^{2n-1-k}\geq
2n+1-k\)</span>，因此后面一部分的分母里同样没有 <span
class="math inline">\(p\)</span>，假设成立。</p>
<p>这也就完成了我们的证明。</p>
<p>因为 <span class="math inline">\(2n\geq 2\)</span> 的时候，<span
class="math inline">\(2-1,3-1\)</span> 一定整除 <span
class="math inline">\(2n\)</span>，所以 <span
class="math inline">\(\forall n\geq 1\)</span>,<span
class="math inline">\(B_{2n}\)</span> 的分母一定是 <span
class="math inline">\(6\)</span> 的倍数。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://06devout.github.io/blog/2024/01/03/%E3%80%90M-3%E3%80%91%E5%91%A8%E9%95%BF%E4%B8%80%E5%AE%9A%E7%9A%84%E9%97%AD%E5%90%88%E6%9B%B2%E7%BA%BF%E4%B8%BA%E5%9C%86%E6%97%B6%E5%9B%B4%E6%88%90%E7%9A%84%E9%9D%A2%E7%A7%AF%E6%9C%80%E5%A4%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.luogu.com.cn/upload/usericon/97344.png">
      <meta itemprop="name" content="devout">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devout">
      <meta itemprop="description" content="拼命地，想把双手伸向暗云的天空中 ...为了寻找那远而不可及的彼岸的某些东西">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | devout">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2024/01/03/%E3%80%90M-3%E3%80%91%E5%91%A8%E9%95%BF%E4%B8%80%E5%AE%9A%E7%9A%84%E9%97%AD%E5%90%88%E6%9B%B2%E7%BA%BF%E4%B8%BA%E5%9C%86%E6%97%B6%E5%9B%B4%E6%88%90%E7%9A%84%E9%9D%A2%E7%A7%AF%E6%9C%80%E5%A4%A7/" class="post-title-link" itemprop="url">【M#3】周长一定的闭合曲线为圆时围成的面积最大</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-01-03 20:28:23 / Modified: 21:07:00" itemprop="dateCreated datePublished" datetime="2024-01-03T20:28:23+08:00">2024-01-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/M/" itemprop="url" rel="index"><span itemprop="name">M</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>我们在这里证明一个广为人知的结论，即周长一定的闭合曲线为圆时围成的面积最大。</p>
<p>具体的，对于平面上的一条闭合曲线 <span
class="math inline">\(\gamma:[a,b]\to \mathbb R^2\)</span> ，<span
class="math inline">\(\gamma(a)=\gamma(b)\)</span>，其长度定义为</p>
<p><span class="math display">\[\ell=\int_a^b
\sqrt{(x^\prime)^2(t)+(y^\prime)^2(t)}\mathrm dt\]</span></p>
<p>其面积定义为</p>
<p><span class="math display">\[\mathcal A=\frac{1}{2}\Bigg|\int_a^b
x(t)y^\prime(t)-x^\prime(t)y(t)\mathrm dt \Bigg|\]</span></p>
<p>则有</p>
<p><span class="math display">\[\mathcal A\leq
\frac{\ell^2}{4\pi}\]</span></p>
<p>当且仅当 <span class="math inline">\(\gamma\)</span>
为一个圆时等式成立。</p>
<p>首先，我们需要把曲线转化成一个标准的形式。</p>
<p>对 <span class="math inline">\(t\)</span> 做变量代换，我们可以把
<span class="math inline">\(\gamma\)</span> 定义到 <span
class="math inline">\([0,2\pi]\)</span> 上。</p>
<p>其次，调整 <span class="math inline">\(x(t),y(t)\)</span>
使得任意时刻 <span
class="math inline">\((x^\prime)^2(t)+(y^\prime)^2(t)=1\)</span>，这样我们将曲线的
<span class="math inline">\(\ell\)</span> 调整为 <span
class="math inline">\(2\pi\)</span>，接下来我们只需要证明 <span
class="math inline">\(\mathcal A\leq \pi\)</span> 即可。</p>
<p>注意到 <span
class="math inline">\(\gamma(0)=\gamma(2\pi)\)</span>，我们可以将 <span
class="math inline">\(x(t)\)</span> 和 <span
class="math inline">\(y(t)\)</span> 分别写成傅里叶级数的表达</p>
<p><span class="math display">\[x(t)\sim \sum a_ne^{int} \text{ and }
y(t)\sim \sum b_ne^{int}\]</span></p>
<p>则</p>
<p><span class="math display">\[x^\prime(t) \sim \sum a_nine^{int}
\text{ and } y^\prime(t)\sim \sum b_nine^{int}\]</span></p>
<p>则</p>
<p><span class="math display">\[\mathcal A=\Big|\pi \sum
n(a_n\overline{b_n}-b_n\overline{a_n})\Big|\]</span></p>
<p>利用</p>
<p><span class="math display">\[n\leq n^2 \tag{1}\]</span></p>
<p><span
class="math display">\[|a_n\overline{b_n}-b_n\overline{a_n}|\leq
2|a_n||b_n| \tag{2}\]</span></p>
<p><span class="math display">\[2|a_n||b_n|\leq |a_n|^2+|b_n|^2
\tag{3}\]</span></p>
<p>得到</p>
<p><span class="math display">\[\mathcal A\leq \pi \sum
n^2(|a_n|^2+|b_n|^2)=\pi ||x(t)||\cdot ||y(t)||=\pi \tag{4}\]</span></p>
<p>接下来考虑取等条件，<span class="math inline">\((1)\)</span> 说明
<span class="math inline">\(a_k(|k|\geq 2)=0\)</span>，因为 <span
class="math inline">\(x(t),y(t)\in\mathbb R\)</span>，说明 <span
class="math inline">\(a_1=\overline{a_{-1}},b_1=\overline{b_{-1}}\)</span>，<span
class="math inline">\((4)\)</span> 说明 <span
class="math inline">\(|a_1|^2+|a_2|^2=1/2\)</span>，<span
class="math inline">\((3)\)</span> 说明 <span
class="math inline">\(|a_1|=|b_1|=\frac{1}{2}\)</span></p>
<p>因此可设</p>
<p><span class="math display">\[a_1=\frac{1}{2}e^{in\alpha} \text{ and }
b_1=\frac{1}{2}e^{in\beta}\]</span></p>
<p>带入 <span class="math inline">\((3)\)</span>，得到 <span
class="math inline">\(|\sin(\alpha-\beta)|=1\)</span>，也就是说 <span
class="math inline">\(a_1\)</span> 和 <span
class="math inline">\(b_1\)</span> 是垂直的。</p>
<p>旋转坐标系到 <span class="math inline">\(\alpha\)</span>，不妨设
<span
class="math inline">\(\beta=\alpha+\dfrac{\pi}{2}\)</span>，在新的坐标系下，有</p>
<p><span class="math display">\[x(t)=a_0+2a_1\cos t\text{ and
}y(t)=b_0+2b_1\sin t\]</span></p>
<p>这正是圆的形式。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://06devout.github.io/blog/2023/12/31/%E3%80%90Ynoi-35%E3%80%91%E3%80%90Ynoi2017%E3%80%91%E7%94%B1%E4%B9%83%E7%9A%84%E7%8E%89%E7%B1%B3%E7%94%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.luogu.com.cn/upload/usericon/97344.png">
      <meta itemprop="name" content="devout">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devout">
      <meta itemprop="description" content="拼命地，想把双手伸向暗云的天空中 ...为了寻找那远而不可及的彼岸的某些东西">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | devout">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2023/12/31/%E3%80%90Ynoi-35%E3%80%91%E3%80%90Ynoi2017%E3%80%91%E7%94%B1%E4%B9%83%E7%9A%84%E7%8E%89%E7%B1%B3%E7%94%B0/" class="post-title-link" itemprop="url">【Ynoi#35】【Ynoi2017】由乃的玉米田</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-12-31 17:54:58" itemprop="dateCreated datePublished" datetime="2023-12-31T17:54:58+08:00">2023-12-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-12-30 18:25:57" itemprop="dateModified" datetime="2023-12-30T18:25:57+08:00">2023-12-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Ynoi/" itemprop="url" rel="index"><span itemprop="name">Ynoi</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>莫队加 bitset 解决前三个操作</p>
<p>第四个操作在 <span class="math inline">\(x&gt;\sqrt n\)</span>
的时候同样解决了。</p>
<p><span class="math inline">\(x\leq \sqrt n\)</span> 的时候，对于 <span
class="math inline">\(x\)</span> 相同的放在一起处理，设 <span
class="math inline">\(f[i]\)</span> 表示最大的 <span
class="math inline">\(j\)</span> 满足 <span
class="math inline">\([i,j]\)</span> 中有一对商是 <span
class="math inline">\(x\)</span> 的，不难转移。</p>
<p>复杂度 <span class="math inline">\(O(n\sqrt n)\)</span></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># <span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> Rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> _Rep(i,a,b) for(int i=a;i&gt;=b;i--)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> RepG(i,u) for(int i=head[u];~i;i=e[i].next)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">double</span> db;</span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> chkmax(a,b) a=max(a,b)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> chkmin(a,b) a=min(a,b)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> mkp make_pair</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;<span class="type">int</span> f=<span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> c=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">for</span>(;!<span class="built_in">isdigit</span>(c);c=<span class="built_in">getchar</span>())<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>)f=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(;<span class="built_in">isdigit</span>(c);c=<span class="built_in">getchar</span>())x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+c-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    x*=f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="type">int</span> pos[N],sq;</span><br><span class="line"><span class="type">int</span> cnt[N];</span><br><span class="line"><span class="type">int</span> lst[N],f[N];</span><br><span class="line"><span class="type">int</span> out[N];</span><br><span class="line"><span class="type">int</span> lim=<span class="number">300</span>;</span><br><span class="line"><span class="type">int</span> qcnt;</span><br><span class="line"></span><br><span class="line">bitset&lt;N&gt; S,SI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">misaka</span>&#123;</span><br><span class="line">    <span class="type">int</span> opt,l,r,x,id;</span><br><span class="line">&#125;Q[N];</span><br><span class="line"></span><br><span class="line">vector&lt;misaka&gt; T[<span class="number">305</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(misaka x,misaka y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(pos[x.l]!=pos[y.l])<span class="keyword">return</span> pos[x.l]&lt;pos[y.l];</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(pos[x.l]&amp;<span class="number">1</span>)<span class="keyword">return</span> x.r&lt;y.r;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> x.r&gt;y.r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!cnt[x])S[x]=<span class="number">1</span>,SI[<span class="number">100000</span>-x]=<span class="number">1</span>;</span><br><span class="line">    cnt[x]++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    cnt[x]--;</span><br><span class="line">    <span class="keyword">if</span>(!cnt[x])S[x]=<span class="number">0</span>,SI[<span class="number">100000</span>-x]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="meta"># <span class="keyword">ifndef</span> ONLINE_JUDGE</span></span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;testdata.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">    <span class="comment">//freopen(&quot;test1.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="meta"># <span class="keyword">endif</span></span></span><br><span class="line">    <span class="built_in">read</span>(n),<span class="built_in">read</span>(m);</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,n)<span class="built_in">read</span>(a[i]);</span><br><span class="line">    sq=<span class="built_in">sqrt</span>(n)+<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,n)pos[i]=(i<span class="number">-1</span>)/sq+<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,m)&#123;</span><br><span class="line">        <span class="type">int</span> opt,x,l,r;</span><br><span class="line">        <span class="built_in">read</span>(opt),<span class="built_in">read</span>(l),<span class="built_in">read</span>(r),<span class="built_in">read</span>(x);</span><br><span class="line">        <span class="keyword">if</span>(opt==<span class="number">4</span>&amp;&amp;x&lt;=lim)T[x].<span class="built_in">push_back</span>((misaka)&#123;<span class="number">4</span>,l,r,x,i&#125;);</span><br><span class="line">        <span class="keyword">else</span> Q[++qcnt]=(misaka)&#123;opt,l,r,x,i&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(Q+<span class="number">1</span>,Q+qcnt+<span class="number">1</span>,cmp);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,l=<span class="number">1</span>,r=<span class="number">0</span>;i&lt;=qcnt;i++)&#123;</span><br><span class="line">        <span class="keyword">while</span>(l&gt;Q[i].l)<span class="built_in">ins</span>(a[--l]);</span><br><span class="line">        <span class="keyword">while</span>(r&lt;Q[i].r)<span class="built_in">ins</span>(a[++r]);</span><br><span class="line">        <span class="keyword">while</span>(l&lt;Q[i].l)<span class="built_in">del</span>(a[l++]);</span><br><span class="line">        <span class="keyword">while</span>(r&gt;Q[i].r)<span class="built_in">del</span>(a[r--]);</span><br><span class="line">        <span class="keyword">if</span>(Q[i].opt==<span class="number">1</span>)out[Q[i].id]=((S&lt;&lt;Q[i].x)&amp;S).<span class="built_in">any</span>();</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(Q[i].opt==<span class="number">2</span>)out[Q[i].id]=((S&lt;&lt;(<span class="number">100000</span>-Q[i].x))&amp;SI).<span class="built_in">any</span>();</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(Q[i].opt==<span class="number">3</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j*j&lt;=Q[i].x;j++)</span><br><span class="line">                <span class="keyword">if</span>(Q[i].x%j==<span class="number">0</span>&amp;&amp;S[j]&amp;&amp;S[Q[i].x/j])</span><br><span class="line">                    out[Q[i].id]=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j*Q[i].x&lt;=<span class="number">100000</span>;j++)</span><br><span class="line">                <span class="keyword">if</span>(S[j]&amp;&amp;S[j*Q[i].x])</span><br><span class="line">                    out[Q[i].id]=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Rep</span>(x,<span class="number">1</span>,lim)&#123;</span><br><span class="line">        <span class="keyword">if</span>(T[x].<span class="built_in">empty</span>())<span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">Rep</span>(i,<span class="number">1</span>,n)&#123;</span><br><span class="line">            <span class="type">int</span> y=a[i];</span><br><span class="line">            lst[y]=i;</span><br><span class="line">            f[i]=f[i<span class="number">-1</span>];</span><br><span class="line">            <span class="keyword">if</span>(x*y&lt;=<span class="number">100000</span>)<span class="built_in">chkmax</span>(f[i],lst[x*y]);</span><br><span class="line">            <span class="keyword">if</span>(y%x==<span class="number">0</span>)<span class="built_in">chkmax</span>(f[i],lst[y/x]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> i:T[x])</span><br><span class="line">            out[i.id]=i.l&lt;=f[i.r];</span><br><span class="line">        <span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="built_in">sizeof</span>(f));</span><br><span class="line">        <span class="built_in">memset</span>(lst,<span class="number">0</span>,<span class="built_in">sizeof</span>(lst));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,m)<span class="built_in">puts</span>(out[i]?<span class="string">&quot;yuno&quot;</span>:<span class="string">&quot;yumi&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://06devout.github.io/blog/2023/12/30/%E3%80%90Ynoi-34%E3%80%91%E3%80%90Ynoi2017%E3%80%91%E7%94%B1%E4%B9%83%E7%9A%84OJ/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.luogu.com.cn/upload/usericon/97344.png">
      <meta itemprop="name" content="devout">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devout">
      <meta itemprop="description" content="拼命地，想把双手伸向暗云的天空中 ...为了寻找那远而不可及的彼岸的某些东西">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | devout">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2023/12/30/%E3%80%90Ynoi-34%E3%80%91%E3%80%90Ynoi2017%E3%80%91%E7%94%B1%E4%B9%83%E7%9A%84OJ/" class="post-title-link" itemprop="url">【Ynoi#34】【Ynoi2017】由乃的OJ</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2023-12-30 17:44:15 / Modified: 18:26:32" itemprop="dateCreated datePublished" datetime="2023-12-30T17:44:15+08:00">2023-12-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Ynoi/" itemprop="url" rel="index"><span itemprop="name">Ynoi</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>首先注意到每一位是独立的，只需要枚举 <span
class="math inline">\(0\)</span> 进去还是 <span
class="math inline">\(1\)</span> 进去对应的就可以算出来。</p>
<p>这个不难用树剖线段树/LCT 维护，得到 3log 的做法。</p>
<p>然后可以用一个 unsigned long long 把每一位压到一起，然后就 2log(1log)
了。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> Rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> _Rep(i,a,b) for(int i=a;i&gt;=b;i--)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> RepG(i,u) for(int i=head[u];~i;i=e[i].next)</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> inf=<span class="number">0</span><span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> db double</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> uint unsigned int</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> chkmax(a,b) a=max(a,b)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> chkmin(a,b) a=min(a,b)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> mkp make_pair</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PIL pair<span class="string">&lt;int,ll&gt;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PLI pair<span class="string">&lt;ll,int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;<span class="type">int</span> f=<span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> c=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">for</span>(;!<span class="built_in">isdigit</span>(c);c=<span class="built_in">getchar</span>())<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>)f=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(;<span class="built_in">isdigit</span>(c);c=<span class="built_in">getchar</span>())x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+c-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    x*=f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m,bit;</span><br><span class="line"><span class="type">int</span> head[N],cnt;</span><br><span class="line"><span class="type">int</span> o[N];</span><br><span class="line">ull a[N];</span><br><span class="line"><span class="type">int</span> dfn[N],siz[N],_a[N],top[N],dep[N],faz[N],son[N],dfsxu;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>&#123;</span><br><span class="line">    <span class="type">int</span> to,next;</span><br><span class="line">&#125;e[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">    e[++cnt]=(Edge)&#123;y,head[x]&#125;,head[x]=cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">    ull l0,l1,r0,r1;</span><br><span class="line">    <span class="built_in">node</span>()&#123;l0=r0=<span class="number">0</span>,l1=r1=inf;&#125;</span><br><span class="line">&#125;seg[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> fa)</span></span>&#123;</span><br><span class="line">    faz[u]=fa,dep[u]=dep[fa]+<span class="number">1</span>;</span><br><span class="line">    siz[u]=<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">RepG</span>(i,u)&#123;</span><br><span class="line">        <span class="type">int</span> v=e[i].to;</span><br><span class="line">        <span class="keyword">if</span>(v==fa)<span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs1</span>(v,u);</span><br><span class="line">        siz[u]+=siz[v];</span><br><span class="line">        <span class="keyword">if</span>(siz[v]&gt;siz[son[u]])son[u]=v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> _top)</span></span>&#123;</span><br><span class="line">    dfn[u]=++dfsxu;</span><br><span class="line">    _a[dfsxu]=u;</span><br><span class="line">    top[u]=_top;</span><br><span class="line">    <span class="keyword">if</span>(!son[u])<span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">dfs2</span>(son[u],_top);</span><br><span class="line">    <span class="built_in">RepG</span>(i,u)&#123;</span><br><span class="line">        <span class="type">int</span> v=e[i].to;</span><br><span class="line">        <span class="keyword">if</span>(v==faz[u]||v==son[u])<span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs2</span>(v,v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> lc (u&lt;&lt;1)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> rc (u&lt;&lt;1|1)</span></span><br><span class="line"></span><br><span class="line"><span class="function">ull <span class="title">calc</span><span class="params">(ull x,<span class="type">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(o[p]==<span class="number">1</span>)<span class="keyword">return</span> x&amp;a[p];</span><br><span class="line">    <span class="keyword">if</span>(o[p]==<span class="number">2</span>)<span class="keyword">return</span> x|a[p];</span><br><span class="line">    <span class="keyword">if</span>(o[p]==<span class="number">3</span>)<span class="keyword">return</span> x^a[p];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">node <span class="title">merge</span><span class="params">(node x,node y)</span></span>&#123;</span><br><span class="line">    node res;</span><br><span class="line">    res.l0=(x.l0&amp;y.l1)|((~x.l0)&amp;y.l0); </span><br><span class="line">    res.l1=(x.l1&amp;y.l1)|((~x.l1)&amp;y.l0);</span><br><span class="line">    res.r0=(y.r0&amp;x.r1)|((~y.r0)&amp;x.r0);</span><br><span class="line">    res.r1=(y.r1&amp;x.r1)|((~y.r1)&amp;x.r0);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        seg[u].l0=seg[u].r0=<span class="built_in">calc</span>(<span class="number">0</span>,_a[l]);</span><br><span class="line">        seg[u].l1=seg[u].r1=<span class="built_in">calc</span>(inf,_a[l]);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(lc,l,mid);</span><br><span class="line">    <span class="built_in">build</span>(rc,mid+<span class="number">1</span>,r);</span><br><span class="line">    seg[u]=<span class="built_in">merge</span>(seg[lc],seg[rc]);  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        seg[u].l0=seg[u].r0=<span class="built_in">calc</span>(<span class="number">0</span>,_a[l]);</span><br><span class="line">        seg[u].l1=seg[u].r1=<span class="built_in">calc</span>(inf,_a[l]);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid)<span class="built_in">update</span>(lc,l,mid,x);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">update</span>(rc,mid+<span class="number">1</span>,r,x);</span><br><span class="line">    seg[u]=<span class="built_in">merge</span>(seg[lc],seg[rc]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">node <span class="title">query</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> ql,<span class="type">int</span> qr)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=ql&amp;&amp;r&lt;=qr)<span class="keyword">return</span> seg[u];</span><br><span class="line">    <span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(qr&lt;=mid)<span class="keyword">return</span> <span class="built_in">query</span>(lc,l,mid,ql,qr);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(ql&gt;mid)<span class="keyword">return</span> <span class="built_in">query</span>(rc,mid+<span class="number">1</span>,r,ql,qr);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">merge</span>(<span class="built_in">query</span>(lc,l,mid,ql,qr),<span class="built_in">query</span>(rc,mid+<span class="number">1</span>,r,ql,qr));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">node <span class="title">RouteQuery</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">    node l,r;</span><br><span class="line">    <span class="keyword">while</span>(top[x]!=top[y])</span><br><span class="line">        <span class="keyword">if</span>(dfn[top[x]]&gt;dfn[top[y]])&#123;</span><br><span class="line">            l=<span class="built_in">merge</span>(<span class="built_in">query</span>(<span class="number">1</span>,<span class="number">1</span>,n,dfn[top[x]],dfn[x]),l);</span><br><span class="line">            x=faz[top[x]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            r=<span class="built_in">merge</span>(<span class="built_in">query</span>(<span class="number">1</span>,<span class="number">1</span>,n,dfn[top[y]],dfn[y]),r);</span><br><span class="line">            y=faz[top[y]];</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span>(dfn[x]&lt;dfn[y])r=<span class="built_in">merge</span>(<span class="built_in">query</span>(<span class="number">1</span>,<span class="number">1</span>,n,dfn[x],dfn[y]),r);</span><br><span class="line">    <span class="keyword">else</span> l=<span class="built_in">merge</span>(<span class="built_in">query</span>(<span class="number">1</span>,<span class="number">1</span>,n,dfn[y],dfn[x]),l);</span><br><span class="line">    <span class="built_in">swap</span>(l.l0,l.r0),<span class="built_in">swap</span>(l.l1,l.r1);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">merge</span>(l,r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="meta"># <span class="keyword">ifndef</span> ONLINE_JUDGE</span></span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;testdata.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">    <span class="comment">//freopen(&quot;test1.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="meta"># <span class="keyword">endif</span></span></span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="built_in">sizeof</span>(head));</span><br><span class="line">    <span class="built_in">read</span>(n),<span class="built_in">read</span>(m),<span class="built_in">read</span>(bit);</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,n)<span class="built_in">read</span>(o[i]),<span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,n<span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="type">int</span> x,y;</span><br><span class="line">        <span class="built_in">read</span>(x),<span class="built_in">read</span>(y);</span><br><span class="line">        <span class="built_in">add</span>(x,y),<span class="built_in">add</span>(y,x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs1</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">dfs2</span>(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,m)&#123;</span><br><span class="line">        <span class="type">int</span> opt,x,y;</span><br><span class="line">        ull z;</span><br><span class="line">        <span class="built_in">read</span>(opt),<span class="built_in">read</span>(x),<span class="built_in">read</span>(y),<span class="built_in">read</span>(z);</span><br><span class="line">        <span class="keyword">if</span>(opt==<span class="number">2</span>)&#123;</span><br><span class="line">            o[x]=y;</span><br><span class="line">            a[x]=z;</span><br><span class="line">            <span class="built_in">update</span>(<span class="number">1</span>,<span class="number">1</span>,n,dfn[x]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            node res=<span class="built_in">RouteQuery</span>(x,y);</span><br><span class="line">            ull ans=<span class="number">0</span>;</span><br><span class="line">            _Rep(i,<span class="number">63</span>,<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="type">int</span> v0=(res.l0&gt;&gt;i)&amp;<span class="number">1ull</span>;</span><br><span class="line">                <span class="type">int</span> v1=(res.l1&gt;&gt;i)&amp;<span class="number">1ull</span>;</span><br><span class="line">                <span class="keyword">if</span>(v0&gt;=v1||((<span class="number">1ull</span>&lt;&lt;i)&gt;z))ans|=(v0?(<span class="number">1ull</span>&lt;&lt;i):<span class="number">0</span>);</span><br><span class="line">                <span class="keyword">else</span> ans|=(v1?(<span class="number">1ull</span>&lt;&lt;i):<span class="number">0</span>),z-=<span class="number">1ull</span>&lt;&lt;i;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%llu\n&quot;</span>,ans);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://06devout.github.io/blog/2023/12/29/Steins-%E5%82%85%E9%87%8C%E5%8F%B6%E5%88%86%E6%9E%90-%E7%AC%AC%E4%B8%89%E7%AB%A0%E9%83%A8%E5%88%86%E4%B9%A0%E9%A2%98%E8%A7%A3%E7%AD%94/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.luogu.com.cn/upload/usericon/97344.png">
      <meta itemprop="name" content="devout">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devout">
      <meta itemprop="description" content="拼命地，想把双手伸向暗云的天空中 ...为了寻找那远而不可及的彼岸的某些东西">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | devout">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2023/12/29/Steins-%E5%82%85%E9%87%8C%E5%8F%B6%E5%88%86%E6%9E%90-%E7%AC%AC%E4%B8%89%E7%AB%A0%E9%83%A8%E5%88%86%E4%B9%A0%E9%A2%98%E8%A7%A3%E7%AD%94/" class="post-title-link" itemprop="url">Steins 傅里叶分析 第三章部分习题解答</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-12-29 22:00:56" itemprop="dateCreated datePublished" datetime="2023-12-29T22:00:56+08:00">2023-12-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-01-02 18:56:49" itemprop="dateModified" datetime="2024-01-02T18:56:49+08:00">2024-01-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Steins-I/" itemprop="url" rel="index"><span itemprop="name">Steins I</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="exercise-6">Exercise 6</h2>
<p>假设存在 <span class="math inline">\(f\)</span> 的傅里叶系数是 <span
class="math inline">\(\{a\}\)</span>，则 <span
class="math inline">\(|f|\leq M\)</span></p>
<p><span
class="math display">\[A_r(f)(0)=\bigg|\frac{1}{2\pi}\int_{-\pi}^{\pi}P_r(0-t)f(t)\mathrm
dt\bigg|\leq M\frac{1}{2\pi}\int_{-\pi}^\pi P_r(t)\mathrm
dt=M\]</span></p>
<p>另一方面，</p>
<p><span class="math display">\[\bigg|\sum_{n={-\infty}}^\infty
a_nr^{|n|}e^{in\theta}\bigg|=\sum_{n=1}^{\infty} \frac{r^n}{n}\to
\infty(r\to 1)\]</span></p>
<p>出现矛盾。</p>
<h2 id="exercise-10">Exercise 10</h2>
<p><span class="math display">\[
\begin{aligned}
E^\prime(t)&amp;=\rho\int_0^{L}\frac{\partial u}{\partial
t}\frac{\partial^2 u}{\partial t^2}\mathrm dx+\tau\int_0^L
\frac{\partial u}{\partial x}\frac{\partial^2 u}{\partial x\partial
t}\mathrm dx \\
&amp;=\rho\int_0^{L}\frac{\partial u}{\partial t}\frac{\partial^2
u}{\partial t^2}\mathrm dx+\tau \frac{\partial u}{\partial
t}\frac{\partial u}{\partial x}\Big|_0^L-\tau \int_0^L \frac{\partial
u}{\partial t}\frac{\partial^2 u}{\partial x^2}\mathrm dx \\
&amp;=0
\end{aligned}
\]</span></p>
<h2 id="exercise-12">Exercise 12</h2>
<p>注意到 <span class="math inline">\(\dfrac{1}{\sin
\dfrac{x}{2}}-\dfrac{2}{x}\)</span> 在 <span
class="math inline">\(0\)</span> 处是可去间断点，补充定义后可令其 <span
class="math inline">\(\in \mathcal R[0,\pi]\)</span>，由
Riemann-Lebesgue Lemma</p>
<p><span
class="math display">\[\int_0^{\pi}\Bigg(\frac{1}{\sin\dfrac{x}{2}}-\frac{2}{x}\bigg)\sin(N+\frac{1}{2})x\mathrm
dx\to 0,N\to \infty\]</span></p>
<p>而</p>
<p><span class="math display">\[\int_0^\pi
\frac{\sin(N+\dfrac{1}{2})x}{\sin \dfrac{x}{2}}\mathrm dx=\int_0^\pi
D_N(x)\mathrm dx=\pi\]</span></p>
<p>得到</p>
<p><span class="math display">\[\int_0^\pi
\frac{\sin(N+\dfrac{1}{2})x}{x}\mathrm dx\to
\frac{\pi}{2},N\to\infty,N\in \mathbb Z\]</span></p>
<p>换元得到</p>
<p><span class="math display">\[\int_0^{(N+\frac{1}{2})\pi} \frac{\sin
x}{x}\mathrm dx\to \frac{\pi}{2},N\to\infty,N\in \mathbb Z\]</span></p>
<p>两边取极限即得所求为 <span
class="math inline">\(\dfrac{\pi}{2}\)</span></p>
<h2 id="exercise-14">Exercise 14</h2>
<p><span class="math inline">\(\hat f^\prime(n)=\dfrac{1}{in}\hat
f(n)\)</span></p>
<p>于是有</p>
<p><span class="math display">\[\sum_{n\neq 0} |\hat f(n)|\leq
\sum_{n\neq 0}\dfrac{|\hat f^\prime(n)|}{|n|}\leq \sqrt{\sum_{n\neq
0}|\hat f^\prime(n)|^2}\cdot\sqrt{\sum_{n\neq
0}\frac{1}{n^2}}=C||f^\prime||&lt; \infty\]</span></p>
<p>于是 <span class="math inline">\(\sum |\hat f(n)|\)</span>
绝对收敛，即一致收敛。</p>
<h2 id="exercise-18">Exercise 18</h2>
<p>因为 <span class="math inline">\(\epsilon_n\to\infty\)</span>，所以
<span class="math inline">\(\forall k\in \mathbb Z^+,\exist
\epsilon_{n_k}&lt;\dfrac{1}{2^k}\)</span>，取 <span
class="math inline">\(f=\sum \epsilon_{n_k}e^{in_kx}\)</span> 即可。</p>
<p>这个练习归纳了之前关于傅里叶级数收敛速度的一些结论。</p>
<ul>
<li><span class="math inline">\(f\in C^k\Rightarrow \hat
f(n)=O(1/|n|^k)\)</span></li>
<li><span class="math inline">\(f\)</span> is Lipschitz <span
class="math inline">\(\Rightarrow \hat f(n)=O(1/|n|)\)</span></li>
<li><span class="math inline">\(f\)</span> is monotonic <span
class="math inline">\(\Rightarrow \hat f(n)=O(1/|n|)\)</span></li>
<li><span class="math inline">\(f\)</span> satisfies Holder's condition
with exponent <span class="math inline">\(0&lt;\alpha&lt;1 \Rightarrow
\hat f(n)=O(1/|n|^{\alpha})\)</span></li>
<li><span class="math inline">\(f\)</span> is Riemann Integrable <span
class="math inline">\(\Rightarrow \hat f\in \ell^2,\hat
f(n)=o(1)\)</span></li>
</ul>
<h2 id="problem-1">Problem 1</h2>
<ol type="a">
<li></li>
</ol>
<p><span class="math display">\[\tilde
D_N(x)=\frac{\cos\dfrac{x}{2}-\cos(N+\dfrac{1}{2})x}{\sin
\dfrac{x}{2}}\]</span></p>
<p>用和差化积</p>
<p><span class="math display">\[|\tilde
D_N(x)|=2\frac{|\sin(\dfrac{N}{2}+1)x\sin Nx|}{|\sin\dfrac{x}{2}|}\leq
2\pi\frac{|\sin Nx|}{|x|}\]</span></p>
<p>其中用了 <span class="math inline">\(|\sin(\dfrac{N}{2}+1)x| \leq
1\)</span> 和 Jordan 不等式 <span class="math inline">\(|\sin
\dfrac{x}{2}|\geq |\dfrac{x}{\pi}|\)</span></p>
<p>对 <span class="math inline">\(\dfrac{|\sin Nx|}{|x|}\)</span> 在
<span class="math inline">\([0,\pi]\)</span> 上积分，考虑对 <span
class="math inline">\(\sin Nx\)</span> 的符号分段讨论，<span
class="math inline">\(x\)</span>
放缩成区间左端点，就得到了类似调和级数的表达式，因此为 <span
class="math inline">\(O(\log N)\)</span></p>
<ol start="3" type="a">
<li></li>
</ol>
<p>假设 <span class="math inline">\(\sum_{n=1}^\infty\)</span> 是某个
<span class="math inline">\(f\in\mathcal R\)</span> 的傅里叶级数，则</p>
<p><span class="math display">\[(f*\tilde
D_n)(0)=\frac{i}{\pi}\int_0^\pi f(t)\sum_{n=1}^\infty
(e^{int}-e^{-int})\mathrm dt=2i\sum_{n=1}^\infty
\frac{1}{n^\alpha}=\omega(\log N)\]</span></p>
<p>得到矛盾，因此不存在这样的 <span
class="math inline">\(f\)</span>。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://06devout.github.io/blog/2023/12/28/%E3%80%90Ynoi-33%E3%80%91%E3%80%90Ynoi2014%E3%80%91%E4%B8%8D%E5%BD%92%E4%B9%8B%E4%BA%BA%E4%B8%8E%E6%9C%9B%E7%9C%BC%E6%AC%B2%E7%A9%BF%E7%9A%84%E4%BA%BA%E4%BB%AC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.luogu.com.cn/upload/usericon/97344.png">
      <meta itemprop="name" content="devout">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devout">
      <meta itemprop="description" content="拼命地，想把双手伸向暗云的天空中 ...为了寻找那远而不可及的彼岸的某些东西">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | devout">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2023/12/28/%E3%80%90Ynoi-33%E3%80%91%E3%80%90Ynoi2014%E3%80%91%E4%B8%8D%E5%BD%92%E4%B9%8B%E4%BA%BA%E4%B8%8E%E6%9C%9B%E7%9C%BC%E6%AC%B2%E7%A9%BF%E7%9A%84%E4%BA%BA%E4%BB%AC/" class="post-title-link" itemprop="url">【Ynoi#33】【Ynoi2014】不归之人与望眼欲穿的人们</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-12-28 21:45:46" itemprop="dateCreated datePublished" datetime="2023-12-28T21:45:46+08:00">2023-12-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-12-30 18:26:23" itemprop="dateModified" datetime="2023-12-30T18:26:23+08:00">2023-12-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Ynoi/" itemprop="url" rel="index"><span itemprop="name">Ynoi</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>首先有一个经典的结论，就是对于固定的右端点，or 和的不同的值最多只有
<span class="math inline">\(O(\log a)\)</span> 个。</p>
<p>考虑分块，对于每个整块，维护前缀和后缀的所有不同的 or 和。</p>
<p>对于跨越块的区间，每次查询从左向右扫，记录前 <span
class="math inline">\(k-1\)</span> 个块的后缀不同 or
和，然后用这个后缀和第 <span class="math inline">\(k\)</span>
个块的前缀做一个双指针计算答案，然后将前 <span
class="math inline">\(k-1\)</span> 个块的后缀 or 上第 <span
class="math inline">\(k\)</span> 个块，再将第 <span
class="math inline">\(k\)</span> 个块内的后缀加入更新去重即可。</p>
<p>对于块内的部分，我们用 <span class="math inline">\(f(len)\)</span>
表示长度 <span class="math inline">\(\leq len\)</span> 的区间中 or
和最大的是多少，每次询问二分即可。</p>
<p>对于修改，我们暴力重构一个块即可。</p>
<p>注意在块内 <span class="math inline">\(f(len)\)</span>
的部分，对于每个右端点计算 <span class="math inline">\(O(\log
a)\)</span> 个左区间的时候，实际上就是对于每一位求 <span
class="math inline">\(\leq i\)</span> 的第一个
1，这部分如果额外排序的话就会损失一个 <span class="math inline">\(\log
\log
a\)</span>。所以我们从左往右推的时候用队列维护一下这个顺序就可以了，因为除了
<span class="math inline">\(a_i\)</span> 是 <span
class="math inline">\(1\)</span> 的那些为其他位变成 <span
class="math inline">\(1\)</span> 的顺序和 <span
class="math inline">\(i-1\)</span> 是一样的。</p>
<p>复杂度 <span class="math inline">\(O(n\sqrt n\log a)\)</span></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> Rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> _Rep(i,a,b) for(int i=a;i&gt;=b;i--)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> RepG(i,u) for(int i=head[u];~i;i=e[i].next)</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">50005</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M=<span class="number">135</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> db double</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> uint unsigned int</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> chkmax(a,b) a=max(a,b)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> chkmin(a,b) a=min(a,b)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> mkp make_pair</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PIL pair<span class="string">&lt;int,ll&gt;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PLI pair<span class="string">&lt;ll,int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;<span class="type">int</span> f=<span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> c=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">for</span>(;!<span class="built_in">isdigit</span>(c);c=<span class="built_in">getchar</span>())<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>)f=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(;<span class="built_in">isdigit</span>(c);c=<span class="built_in">getchar</span>())x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+c-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    x*=f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="type">int</span> L[N],R[N],pos[N],sq=<span class="number">400</span>,bl;</span><br><span class="line">PII res[<span class="number">66</span>];</span><br><span class="line"><span class="type">int</span> len;</span><br><span class="line"><span class="type">int</span> orsum[M];</span><br><span class="line"><span class="type">int</span> mx[M][<span class="number">405</span>];</span><br><span class="line"><span class="type">int</span> lenp[M],lens[M];</span><br><span class="line">PII pre[M][<span class="number">33</span>],suf[M][<span class="number">33</span>];</span><br><span class="line">PII myq[<span class="number">23333</span>],cach[<span class="number">66</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rebuild</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(mx[x],<span class="number">0</span>,<span class="built_in">sizeof</span>(mx[x]));</span><br><span class="line">    lenp[x]=lens[x]=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> tmp=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">Rep</span>(i,L[x],R[x]) <span class="keyword">if</span>((tmp|a[i])!=pre[x][lenp[x]].first)tmp|=a[i],pre[x][++lenp[x]]=<span class="built_in">mkp</span>(tmp,i);</span><br><span class="line">    tmp=<span class="number">0</span>;</span><br><span class="line">    _Rep(i,R[x],L[x])<span class="keyword">if</span>((tmp|a[i])!=suf[x][lens[x]].first)tmp|=a[i],suf[x][++lens[x]]=<span class="built_in">mkp</span>(tmp,i);</span><br><span class="line">    <span class="type">int</span> head=<span class="number">1</span>,tail=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">Rep</span>(i,L[x],R[x])&#123;</span><br><span class="line">        <span class="type">int</span> lst=tail;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=a[i];j;j-=j&amp;-j)myq[++tail]=<span class="built_in">mkp</span>(__builtin_ctz(j),i);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=head;j&lt;=lst;j++)<span class="keyword">if</span>(!(a[i]&gt;&gt;myq[j].first&amp;<span class="number">1</span>))myq[++tail]=myq[j];</span><br><span class="line">        head=lst+<span class="number">1</span>;</span><br><span class="line">        tmp=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">Rep</span>(j,head,tail)&#123;</span><br><span class="line">            tmp|=a[myq[j].second];</span><br><span class="line">            <span class="built_in">chkmax</span>(mx[x][i-myq[j].second+<span class="number">1</span>],tmp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">2</span>,R[x]-L[x]+<span class="number">1</span>)<span class="built_in">chkmax</span>(mx[x][i],mx[x][i<span class="number">-1</span>]);</span><br><span class="line">    orsum[x]=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">Rep</span>(i,L[x],R[x])orsum[x]|=a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">maintain</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">2</span>,len)<span class="keyword">if</span>(res[i].first==res[i<span class="number">-1</span>].first)res[i].second=res[i<span class="number">-1</span>].second;</span><br><span class="line">    len=<span class="built_in">unique</span>(res+<span class="number">1</span>,res+len+<span class="number">1</span>)-res<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> i=<span class="number">1</span>,j=<span class="number">1</span>,it=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;=len&amp;&amp;j&lt;=lens[x])</span><br><span class="line">        <span class="keyword">if</span>(res[i].first&lt;suf[x][j].first)cach[it++]=res[i++];</span><br><span class="line">        <span class="keyword">else</span> cach[it++]=suf[x][j++];</span><br><span class="line">    <span class="keyword">while</span>(i&lt;=len)cach[it++]=res[i++];</span><br><span class="line">    <span class="keyword">while</span>(j&lt;=lens[x])cach[it++]=suf[x][j++];</span><br><span class="line">    it--;</span><br><span class="line">    len=it;</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,len)res[i]=cach[i];</span><br><span class="line">    <span class="built_in">maintain</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">1e9</span>+<span class="number">114514</span>;</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,lenp[x])</span><br><span class="line">        <span class="keyword">while</span>(len&amp;&amp;(res[len].first|pre[x][i].first)&gt;=k)</span><br><span class="line">            <span class="built_in">chkmin</span>(ans,pre[x][i].second-res[len].second+<span class="number">1</span>),len--;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="meta"># <span class="keyword">ifndef</span> ONLINE_JUDGE</span></span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;testdata.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">    <span class="comment">//freopen(&quot;test1.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="meta"># <span class="keyword">endif</span></span></span><br><span class="line">    <span class="built_in">read</span>(n),<span class="built_in">read</span>(m);</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,n)<span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,n)pos[i]=(i<span class="number">-1</span>)/sq+<span class="number">1</span>;</span><br><span class="line">    bl=pos[n];</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,bl)L[i]=(i<span class="number">-1</span>)*sq+<span class="number">1</span>,R[i]=i*sq;</span><br><span class="line">    R[bl]=n;</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,bl)<span class="built_in">rebuild</span>(i);</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,m)&#123;</span><br><span class="line">        <span class="type">int</span> opt,x,y;</span><br><span class="line">        <span class="built_in">read</span>(opt),<span class="built_in">read</span>(x);</span><br><span class="line">        <span class="keyword">if</span>(opt==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="built_in">read</span>(y);</span><br><span class="line">            a[x]=y;</span><br><span class="line">            <span class="built_in">rebuild</span>(pos[x]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> ans=<span class="number">1e9</span>+<span class="number">114514</span>;</span><br><span class="line">            <span class="built_in">Rep</span>(i,<span class="number">1</span>,bl)<span class="keyword">if</span>(orsum[i]&gt;=x)<span class="built_in">chkmin</span>(ans,(<span class="type">int</span>)(<span class="built_in">lower_bound</span>(mx[i]+<span class="number">1</span>,mx[i]+R[i]-L[i]+<span class="number">2</span>,x)-mx[i]));</span><br><span class="line">            len=<span class="number">0</span>;</span><br><span class="line">            <span class="built_in">merge</span>(<span class="number">1</span>);</span><br><span class="line">            <span class="built_in">Rep</span>(i,<span class="number">2</span>,bl)&#123;</span><br><span class="line">                <span class="built_in">chkmin</span>(ans,<span class="built_in">calc</span>(i,x));</span><br><span class="line">                <span class="built_in">Rep</span>(j,<span class="number">1</span>,len)res[j].first|=orsum[i];</span><br><span class="line">                <span class="built_in">maintain</span>();</span><br><span class="line">                <span class="built_in">merge</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(ans&gt;<span class="number">1e9</span>)<span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans);</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://06devout.github.io/blog/2023/12/27/%E3%80%90Ynoi-32%E3%80%91%E3%80%90Ynoi2014%E3%80%91%E7%AD%89%E8%BF%99%E5%9C%BA%E6%88%98%E4%BA%89%E7%BB%93%E6%9D%9F%E4%B9%8B%E5%90%8E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.luogu.com.cn/upload/usericon/97344.png">
      <meta itemprop="name" content="devout">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devout">
      <meta itemprop="description" content="拼命地，想把双手伸向暗云的天空中 ...为了寻找那远而不可及的彼岸的某些东西">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | devout">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2023/12/27/%E3%80%90Ynoi-32%E3%80%91%E3%80%90Ynoi2014%E3%80%91%E7%AD%89%E8%BF%99%E5%9C%BA%E6%88%98%E4%BA%89%E7%BB%93%E6%9D%9F%E4%B9%8B%E5%90%8E/" class="post-title-link" itemprop="url">【Ynoi#32】【Ynoi2014】等这场战争结束之后</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-12-27 21:42:23" itemprop="dateCreated datePublished" datetime="2023-12-27T21:42:23+08:00">2023-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-12-30 18:26:13" itemprop="dateModified" datetime="2023-12-30T18:26:13+08:00">2023-12-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Ynoi/" itemprop="url" rel="index"><span itemprop="name">Ynoi</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>首先把操作树建出来，然后值域分块。</p>
<p>用可撤销并查集维护连通块，记录每个连通块在每个块中的出现次数。</p>
<p>查询先定位整块，散块只需要在离散化的时候不去重，暴力找即可。</p>
<p>感觉远远没有达到黑的水平。</p>
<p><span class="math inline">\(O(m\sqrt{n\log n})\)</span></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> Rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> _Rep(i,a,b) for(int i=a;i&gt;=b;i--)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> RepG(i,u) for(int i=head[u];~i;i=e[i].next)</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> B=<span class="number">25</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> db double</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> uint unsigned int</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> chkmax(a,b) a=max(a,b)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> chkmin(a,b) a=min(a,b)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> mkp make_pair</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PIL pair<span class="string">&lt;int,ll&gt;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PLI pair<span class="string">&lt;ll,int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;<span class="type">int</span> f=<span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> c=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">for</span>(;!<span class="built_in">isdigit</span>(c);c=<span class="built_in">getchar</span>())<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>)f=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(;<span class="built_in">isdigit</span>(c);c=<span class="built_in">getchar</span>())x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+c-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    x*=f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line">PII a[N];</span><br><span class="line"><span class="type">int</span> b[N];</span><br><span class="line"><span class="type">int</span> head[N],ecnt;</span><br><span class="line"><span class="type">int</span> mode[N];</span><br><span class="line"><span class="type">int</span> fa[N],siz[N],stk[N],top;</span><br><span class="line"><span class="type">short</span> cnt[N][B];</span><br><span class="line"><span class="type">int</span> L[N],R[N],pos[N],sq=<span class="number">4000</span>,bl;</span><br><span class="line"><span class="type">int</span> out[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>&#123;</span><br><span class="line">    <span class="type">int</span> to,next;</span><br><span class="line">&#125;e[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">    e[++ecnt]=(Edge)&#123;y,head[x]&#125;,head[x]=ecnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">misaka</span>&#123;</span><br><span class="line">    <span class="type">int</span> opt,x,y;</span><br><span class="line">&#125;Q[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(fa[x]==x)<span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">find</span>(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">    x=<span class="built_in">find</span>(x),y=<span class="built_in">find</span>(y);</span><br><span class="line">    <span class="keyword">if</span>(x==y)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(siz[x]&gt;siz[y])<span class="built_in">swap</span>(x,y);</span><br><span class="line">    stk[++top]=x;</span><br><span class="line">    fa[x]=y,siz[y]+=siz[x];</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,bl)cnt[y][i]+=cnt[x][i];</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rollback</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> x=stk[top--],y=fa[x];</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,bl)cnt[y][i]-=cnt[x][i];</span><br><span class="line">    siz[y]-=siz[x];</span><br><span class="line">    fa[x]=x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">    x=<span class="built_in">find</span>(x);</span><br><span class="line">    <span class="type">int</span> k=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(k&lt;=bl&amp;&amp;y&gt;cnt[x][k])y-=cnt[x][k],k++;</span><br><span class="line">    <span class="keyword">if</span>(k&gt;bl)<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="built_in">Rep</span>(i,L[k],R[k])</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">find</span>(a[i].second)==x)&#123;</span><br><span class="line">            y--;</span><br><span class="line">            <span class="keyword">if</span>(!y)<span class="keyword">return</span> a[i].first;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="type">bool</span> flag=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(Q[u].opt==<span class="number">1</span>)flag=<span class="built_in">merge</span>(Q[u].x,Q[u].y);</span><br><span class="line">    <span class="keyword">if</span>(Q[u].opt==<span class="number">3</span>)out[u]=<span class="built_in">query</span>(Q[u].x,Q[u].y);</span><br><span class="line">    <span class="built_in">RepG</span>(i,u)<span class="built_in">dfs</span>(e[i].to);</span><br><span class="line">    <span class="keyword">if</span>(flag)<span class="built_in">rollback</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="meta"># <span class="keyword">ifndef</span> ONLINE_JUDGE</span></span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;testdata.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">    <span class="comment">//freopen(&quot;test1.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="meta"># <span class="keyword">endif</span></span></span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="built_in">sizeof</span>(head));</span><br><span class="line">    <span class="built_in">read</span>(n),<span class="built_in">read</span>(m);</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,n)fa[i]=i,siz[i]=<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,n)<span class="built_in">read</span>(a[i].first),a[i].second=i;</span><br><span class="line">    <span class="built_in">sort</span>(a+<span class="number">1</span>,a+n+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,n)b[a[i].second]=i;</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,n)pos[i]=(i<span class="number">-1</span>)/sq+<span class="number">1</span>;</span><br><span class="line">    bl=pos[n];</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,bl)L[i]=(i<span class="number">-1</span>)*sq+<span class="number">1</span>,R[i]=i*sq;</span><br><span class="line">    R[bl]=n;</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,n)cnt[i][pos[b[i]]]++;</span><br><span class="line">    <span class="type">int</span> now=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,m)&#123;</span><br><span class="line">        <span class="type">int</span> opt,x,y;</span><br><span class="line">        <span class="built_in">read</span>(opt),<span class="built_in">read</span>(x);</span><br><span class="line">        <span class="keyword">if</span>(opt==<span class="number">1</span>)<span class="built_in">read</span>(y),Q[i]=(misaka)&#123;<span class="number">1</span>,x,y&#125;,<span class="built_in">add</span>(now,i),now=i;</span><br><span class="line">        <span class="keyword">if</span>(opt==<span class="number">2</span>)now=mode[x];</span><br><span class="line">        <span class="keyword">if</span>(opt==<span class="number">3</span>)<span class="built_in">read</span>(y),Q[i]=(misaka)&#123;<span class="number">3</span>,x,y&#125;,<span class="built_in">add</span>(now,i),now=i;</span><br><span class="line">        mode[i]=now;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,m)<span class="keyword">if</span>(Q[i].opt==<span class="number">3</span>)<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,out[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://06devout.github.io/blog/2023/12/25/%E3%80%90Ynoi-31%E3%80%91%E3%80%90Ynoi2019-%E6%A8%A1%E6%8B%9F%E8%B5%9B%E3%80%91-Yuno-loves-sqrt-technology-III/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.luogu.com.cn/upload/usericon/97344.png">
      <meta itemprop="name" content="devout">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devout">
      <meta itemprop="description" content="拼命地，想把双手伸向暗云的天空中 ...为了寻找那远而不可及的彼岸的某些东西">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | devout">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2023/12/25/%E3%80%90Ynoi-31%E3%80%91%E3%80%90Ynoi2019-%E6%A8%A1%E6%8B%9F%E8%B5%9B%E3%80%91-Yuno-loves-sqrt-technology-III/" class="post-title-link" itemprop="url">【Ynoi#31】【Ynoi2019 模拟赛】 Yuno loves sqrt technology III</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-12-25 20:13:05" itemprop="dateCreated datePublished" datetime="2023-12-25T20:13:05+08:00">2023-12-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-12-30 18:26:05" itemprop="dateModified" datetime="2023-12-30T18:26:05+08:00">2023-12-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/Ynoi/" itemprop="url" rel="index"><span itemprop="name">Ynoi</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><del>2023年第一道洛谷</del></p>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5048">题目链接</a></p>
<p>一句话题意就是静态区间众数出现次数。</p>
<p>分块，先预处理出 <span class="math inline">\(l\)</span> 到 <span
class="math inline">\(r\)</span> 块内出现的众数出现次数。</p>
<p>然后考虑散块的部分，对于新添加的一个数，我们查询他在区间里出现的次数即可，但是这样二分带
log。</p>
<p>解决方法对于当前的 <span
class="math inline">\(ans\)</span>，对于（以右边部分散块为例）一个新的数
<span class="math inline">\(a_k\)</span>，找 <span
class="math inline">\(a_k\)</span> 前面第 <span
class="math inline">\(ans\)</span>
个位置，判断他是否在这个区间内，如果是，<span
class="math inline">\(ans:=ans+1\)</span>，然后一步一步往前跳。</p>
<p>这样均摊下来每个散块里的位置只会被跳一遍，复杂度 <span
class="math inline">\(O((n+m)\sqrt n)\)</span>。</p>
<p>应当说是 Ynoi 里面相当简单的一道题，也不卡常。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> Rep(i,a,b) for(int i=a;i&lt;=b;i++)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> _Rep(i,a,b) for(int i=a;i&gt;=b;i--)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> RepG(i,u) for(int i=head[u];~i;i=e[i].next)</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">5e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M=<span class="number">805</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> db double</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> uint unsigned int</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> chkmax(a,b) a=max(a,b)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> chkmin(a,b) a=min(a,b)</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> mkp make_pair</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PIL pair<span class="string">&lt;int,ll&gt;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> PLI pair<span class="string">&lt;ll,int&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>;<span class="type">int</span> f=<span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> c=<span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">for</span>(;!<span class="built_in">isdigit</span>(c);c=<span class="built_in">getchar</span>())<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>)f=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(;<span class="built_in">isdigit</span>(c);c=<span class="built_in">getchar</span>())x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+c-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    x*=f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="type">int</span> sq=<span class="number">700</span>,bl,L[N],R[N],pos[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p[N];</span><br><span class="line"><span class="type">int</span> mode[M][M],cnt[N];</span><br><span class="line"><span class="type">int</span> loc[N];</span><br><span class="line"><span class="type">int</span> ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="meta"># <span class="keyword">ifndef</span> ONLINE_JUDGE</span></span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;testdata.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">    <span class="comment">//freopen(&quot;test1.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">    <span class="meta"># <span class="keyword">endif</span></span></span><br><span class="line">    <span class="built_in">read</span>(n),<span class="built_in">read</span>(m);</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,n)<span class="built_in">read</span>(a[i]),loc[i]=p[a[i]].<span class="built_in">size</span>(),p[a[i]].<span class="built_in">push_back</span>(i);</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,n)pos[i]=(i<span class="number">-1</span>)/sq+<span class="number">1</span>;</span><br><span class="line">    bl=pos[n];</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,bl)L[i]=(i<span class="number">-1</span>)*sq+<span class="number">1</span>,R[i]=i*sq;</span><br><span class="line">    R[bl]=n;</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,bl)&#123;</span><br><span class="line">        <span class="built_in">Rep</span>(j,i,bl)&#123;</span><br><span class="line">            mode[i][j]=mode[i][j<span class="number">-1</span>];</span><br><span class="line">            <span class="built_in">Rep</span>(k,L[j],R[j])&#123;</span><br><span class="line">                cnt[a[k]]++;</span><br><span class="line">                <span class="built_in">chkmax</span>(mode[i][j],cnt[a[k]]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">Rep</span>(j,L[i],n)cnt[a[j]]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Rep</span>(i,<span class="number">1</span>,m)&#123;</span><br><span class="line">        <span class="type">int</span> x,y;</span><br><span class="line">        <span class="built_in">read</span>(x),<span class="built_in">read</span>(y);</span><br><span class="line">        x^=ans,y^=ans;</span><br><span class="line">        <span class="keyword">if</span>(pos[x]==pos[y])&#123;</span><br><span class="line">            ans=<span class="number">0</span>;</span><br><span class="line">            <span class="built_in">Rep</span>(j,x,y)cnt[a[j]]++,<span class="built_in">chkmax</span>(ans,cnt[a[j]]);</span><br><span class="line">            <span class="built_in">Rep</span>(j,x,y)cnt[a[j]]=<span class="number">0</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ans=mode[pos[x]+<span class="number">1</span>][pos[y]<span class="number">-1</span>];</span><br><span class="line">            <span class="built_in">Rep</span>(j,x,R[pos[x]])&#123;</span><br><span class="line">                <span class="type">int</span> k=loc[j];</span><br><span class="line">                <span class="keyword">while</span>(k+ans&lt;p[a[j]].<span class="built_in">size</span>()&amp;&amp;p[a[j]][k+ans]&lt;=y)ans++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">Rep</span>(j,L[pos[y]],y)&#123;</span><br><span class="line">                <span class="type">int</span> k=loc[j];</span><br><span class="line">                <span class="keyword">while</span>(k-ans&gt;=<span class="number">0</span>&amp;&amp;p[a[j]][k-ans]&gt;=x)ans++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/blog/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/blog/">1</a><span class="page-number current">2</span><a class="page-number" href="/blog/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/5/">5</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/blog/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">devout</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/blog/js/comments.js"></script><script src="/blog/js/utils.js"></script><script src="/blog/js/motion.js"></script><script src="/blog/js/schemes/muse.js"></script><script src="/blog/js/next-boot.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","per_page":true,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/blog/js/third-party/math/mathjax.js"></script>



</body>
</html>
